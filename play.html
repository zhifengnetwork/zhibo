<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
    <title>用户测试用例</title>
    <link rel="stylesheet" href="https://g.alicdn.com/de/prismplayer/2.8.1/skins/default/aliplayer-min.css" />
    <script charset="utf-8" type="text/javascript"
        src="https://g.alicdn.com/de/prismplayer/2.8.1/aliplayer-min.js"></script>
    <script charset="utf-8" type="text/javascript" src="/public/jquery-3.3.1.min.js"></script>

</head>

<body>
    <div class="prism-player" id="J_prismPlayer"></div>
    <script>
        //var url = 'http://play.zhifengwangluo.com/dc/user56895.m3u8?auth_key=1557157678-0-0-bb98df5d61f4e345128fad064798f1fd';
        
        //获取url的播放地址
		var url = GetUrlParam('url');
		console.log(url);
		if(!url || url == undefined){
			url = 'rtmp://live.hkstv.hk.lxdns.com/live/hks'
		}else{
			url = decodeURIComponent(url);
			//存在即解码
		}

		console.log(url);

        // $.ajax({
        //     url: "https://zhibo.zhifengwangluo.com/index/index/flv",
        //     type: 'get',

        //     success: function (res) {
        //         url = res;
        //     },
        //     error: function (res) {
        //         alert(res);
        //     }
        // })

        function GetUrlParam(paraName) {
			var url = document.location.toString();
			var arrObj = url.split("?");

			if (arrObj.length > 1) {
				var arrPara = arrObj[1].split("&");
				var arr;

				for (var i = 0; i < arrPara.length; i++) {
					arr = arrPara[i].split("=");

					if (arr != null && arr[0] == paraName) {
						return arr[1];
					}
				}
				return "";
			}
			else {
				return "";
			}
		}

        var player = new Aliplayer({
            id: 'J_prismPlayer',
            width: '100%',
            autoplay: true,
            //支持播放地址播放,此播放优先级最高

            source : url,
            // source: 'http://img.ksbbs.com/asset/Mon_1703/05cacb4e02f9d9e.mp4',

            /*
            //播放方式二：点播用户推荐
            vid: '1e067a2831b641db90d570b6480fbc40',
            playauth: 'ddd',
            cover: 'http://liveroom-img.oss-cn-qingdao.aliyuncs.com/logo.png',
            //播放方式三：仅MPS用户使用
            vid: '1e067a2831b641db90d570b6480fbc40',
            accId: 'dd',
            accSecret: 'dd',
            stsToken: 'dd',
            domainRegion: 'dd',
            authInfo: 'dd',
            //播放方式四：使用STS方式播放
            vid: '1e067a2831b641db90d570b6480fbc40',
            accessKeyId: 'dd',
            securityToken: 'dd',
            accessKeySecret: 'dd',
            region: 'cn-shanghai',//eu-central-1,ap-southeast-1
            */
        }, function (player) {
            console.log('播放器创建好了。')
        });
    </script>
</body>

</html>